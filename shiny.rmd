---
title: "Shiny"
runtime: shiny
output: html_document
---

## 1. Welcome to Shiny

### Structure of a Shiny App

ui.R
```{r eval=FALSE}
library(shiny)
shinyUI(fluidPage(
    ))
```

server.R
```{r eval=FALSE}
library(shiny)
shinyServer(function(input, output){
    
})
```

### Run an App
```{r eval=FALSE}
library(shiny)
runApp('folder_name_of_App', display.mode = "showcase")
```

## 2. Build a user-interface

### Layout
```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("title panel"),

  sidebarLayout(
    sidebarPanel( "sidebar panel"),
    mainPanel("main panel")
  )
))
```
Sidebar on the right
```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("title panel"),

  sidebarLayout(position = 'right',
    sidebarPanel( "sidebar panel"),
    mainPanel("main panel")
  )
))
```

### Formatted text

* p: paragraph
* h1: header1
* a: hyper link
* div: division of text
* code: code
* img: image
* strong: bold text

```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("My Shiny App"),
  sidebarLayout(
    sidebarPanel(),
    mainPanel(
      h1("First level title"),
      h2("Second level title"),
      h3("Third level title"),
      h4("Fourth level title"),
      h5("Fifth level title"),
      h6("Sixth level title")
    )
  )
))
```
align: `h6("Episode IV", align = "center")` 

```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("My Shiny App"),
  sidebarLayout(
    sidebarPanel(),
    mainPanel(
      p("p creates a paragraph of text. Note: this paragraph is followed by br(), which makes a blank line."),
      p("A new p() command starts a new paragraph. Supply a style attribute to change the format of the entire paragraph", style = "font-family: 'times'; font-si16pt"),
      strong("strong() makes bold text."),
      em("em() creates italicized (i.e, emphasized) text."),
      br(),
      code("code displays your text similar to computer code"),
      div("div creates segments of text with a similar style. This division of text is all blue because I passed the argument 'style = color:blue' to div", style = "color:blue"),
      br(),
      p("span does the same thing as div, but it works with",
        span("groups of words", style = "color:blue"),
        "that appear inside a paragraph.")
    )
  )
))
```

### Images
Put image file in the `www` folder then use `img(src = "my_image.png", height = 72, width = 72)`

## 3. Add control widgets

To add a widgets: `widget_function('widget_id', 'widget_label', other_args)`
```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("Basic widgets"),
  
  fluidRow(
    
    column(3,
      h3("Buttons"),
      actionButton("action", label = "Action"),
      br(),
      br(), 
      submitButton("Submit")),
    
    column(3,
      h3("Single checkbox"),
      checkboxInput("checkbox", label = "Choice A", value = TRUE)),
    
    column(3, 
      checkboxGroupInput("checkGroup", 
        label = h3("Checkbox group"), 
        choices = list("Choice 1" = 1, 
           "Choice 2" = 2, "Choice 3" = 3),
        selected = 1)),
    
    column(3, 
      dateInput("date", 
        label = h3("Date input"), 
        value = "2014-01-01"))   
  ),
  
  fluidRow(
    
    column(3,
      dateRangeInput("dates", label = h3("Date range"))),
    
    column(3,
      fileInput("file", label = h3("File input"))),
    
    column(3, 
      h3("Help text"),
      helpText("Note: help text isn't a true widget,", 
        "but it provides an easy way to add text to",
        "accompany other widgets.")),
    
    column(3, 
      numericInput("num", 
        label = h3("Numeric input"), 
        value = 1))   
  ),
    
  fluidRow(
    
    column(3,
      radioButtons("radio", label = h3("Radio buttons"),
        choices = list("Choice 1" = 1, "Choice 2" = 2,
                       "Choice 3" = 3),selected = 1)),
    
    column(3,
      selectInput("select", label = h3("Select box"), 
        choices = list("Choice 1" = 1, "Choice 2" = 2,
                       "Choice 3" = 3), selected = 1)),
    
    column(3, 
      sliderInput("slider1", label = h3("Sliders"),
        min = 0, max = 100, value = 50),
      sliderInput("slider2", "",
        min = 0, max = 100, value = c(25, 75))
      ),
    
    column(3, 
      textInput("text", label = h3("Text input"), 
        value = "Enter text..."))   
  )

))
```

## 4. Display reactive output

### Add output to UI
Output functions:

* htmlOutput
* imageOutput
* plotOutput
* tableOutput
* textOutput
* uiOutput
* verbatimTextOutput

```{r}
# ui.R
shinyUI(fluidPage(
  titlePanel("censusVis"),
  
  sidebarLayout(
    sidebarPanel(
      helpText("Create demographic maps with 
        information from the 2010 US Census."),
      
      selectInput("var", 
        label = "Choose a variable to display",
        choices = c("Percent White", "Percent Black",
          "Percent Hispanic", "Percent Asian"),
        selected = "Percent White"),
      
      sliderInput("range", 
        label = "Range of interest:",
        min = 0, max = 100, value = c(0, 100))
    ),
    
    mainPanel(
      textOutput("text1")
    )
  )
))
```

Render functions:

* renderImage
* renderPlot
* renderPrint
* renderTable
* renderText
* renderUI

Each `render*` function takes a single argument: `{an_R_expression}`
```{r}
# server.R
shinyServer(
  function(input, output) {
    output$text1 <- renderText({ 
      paste("You have selected", input$var)
    })
  }
)
```

## 5.Use R scripts and data

* Load library: `library(package_name)`
* Load help functions: Put `helpers.R` in the same folder of `server.R`, then `source('helpers.R')`
* Load data: Put `data.rds` in the `data` folder, then `readRDS('data/data.rds')`

The excution logic:

* The `server.R` script is run once, when you launch your app
* The unnamed function inside `shinyServer` is run once each time a user visits your app
* The R expressions inside `render` functions are run many times. Shiny runs them once each time a user changes a widget.

So,

* Source scripts, load libraries, and read data sets at the beginning of `server.R` outside of the `shinyServer` function. 
* Define user specific objects inside `shinyServer`’s unnamed function, but outside of any `render` calls.
* Only place code that Shiny must rerun to build an object inside of a `render` function.

## 6.Use reactive expressions

The `reactive` function cache the data from widgets-including-expression until the widget has been changed: `cacheddata <- reactive({widge_expression})`. Then, in the `rander` function, the cached data can be call with `cacheddata()`.

## 7. Share apps

### runUrl

* Save your Shiny app’s directory as a zip file
* Host that zip file at its own link on a web page. Anyone with access to the link can launch the app from inside R by running:
```{r,eval=FALSE}
library(shiny)
runUrl( "<the weblink>")
```


### runGitHub

To share an app through Github, create a project repository on Github. Then store your server.R and ui.R files in the repository, along with any supplementary files that the app uses.
```{r, eval=FALSE}
runGitHub( "<your repository name>", "<your user name>") 
```
















